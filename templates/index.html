<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>小能导航</title>    <link href="../static/images/static/images/favicon.ico" rel="icon">    <link rel="stylesheet" type="text/css" href="../static/semantic/dist/semantic.css">    <script type="text/javascript" src="../static/vue.js"></script>    <script type="text/javascript" src="../static/Vue.Draggable/dist/Sortable.js"></script>    <script type="text/javascript" src="../static/Vue.Draggable/dist/vuedraggable.js"></script>    <script type="text/javascript" src="../static/Vue.Draggable/dist/vue-material.js"></script>    <script type="text/javascript" src="../static/jquery-3.2.0.min.js"></script>    <script type="text/javascript" src="../static/semantic/dist/semantic.js"></script>    <script type="text/javascript" src="../static/axios/axios.js"></script>    <style>        .ui.four.cards > .card > .image > .img_siez {            display: block;            width: 100%;            height: auto;        }        .ui.modal {            width: 450px;            margin: 0em 0em 0em -275px;        }    </style></head><body>{% verbatim %}<div id="cen">    <!--标题-->    <div class="ui blue inverted mini menu segment fixed">        <div class="ui container">            <div class="ui center aligned">                <img style="height: 34px; width: 306px;" src="../static/images/static/images/logo.png">            </div>            <div class="right menu">                <div class="ui left icon action input">                    <i class="search icon"></i>                    <input type="text" placeholder="搜索" v-model="search_text">                    <div class="ui green submit button">搜索</div>                    <div id="login" class="ui green submit button" style="margin-left: 1em"                         onclick="window.location='http://0.0.0.0:8000/admin/index_app/systeminfo/'"><i class="icon user"></i>登录                    </div>                </div>            </div>        </div>    </div>    <!--布局排序-->    <div style="margin-top: 100px" class="ui container">        <div class="ui header">            <br>            我的收藏            <h2 class="ui section divider"></h2>            <draggable class="ui five  cards" v-model="message_id">                <div class="card" v-for="value in id_data" style="width: 203px; height: 264.05px">                    <div class="ui image center">                        <a v-bind:href="value.url" target="_blank">                            <img v-bind:src="value.image" style="width: 203px; height: 203px">                        </a>                    </div>                    <div class="ui centered header content blurring dimmable special_del">                        <div class="ui dimmer">                            <div class="content">                                <div class="center">                                    <div class="ui primary">                                        <span class="right star" style="cursor: pointer" v-on:click="del_id(value.id)" :data-name="value.id"><i class="star icon"></i> 取消收藏 </span>                                    </div>                                </div>                            </div>                        </div>                        <a class="header">{{ value.name }}</a>                    </div>                </div>            </draggable>        </div>        <div class="ui header" v-for="(v,k) in type_str">            <br>            {{ k }}            <h2 class="ui section divider"></h2>            <draggable class="ui five  cards" v-model="message">                <div class="card" v-for="value in v" style="width: 203px; height: 264.05px">                    <div class="ui image center" style="width: 203px; height: 203px">                        <a v-bind:href="value.url" target="_blank">                            <img v-bind:src="value.image" style="width: 203px; height: 203px">                        </a>                    </div>                    <div class="ui centered header content blurring dimmable special">                        <div class="ui dimmer">                            <div class="content">                                <div class="center">                                    <div class="ui primary">                                        <span class="right star" style="cursor: pointer" v-on:click="get_id(value.id)" :data-name="value.id"><i class="star icon"></i> 添加收藏 </span>                                    </div>                                </div>                            </div>                        </div>                        <a class="header" target="_blank" v-bind:href="value.url">{{ value.name }}</a>                    </div>                </div>            </draggable>        </div>    </div>    <div class="ui basic modal actions middle aligned center aligned grid">        <div class="column">            <h2 class="ui teal image header">                <div class="content">                    小能索引页登录                </div>            </h2>            <form class="ui large form">                <div class="ui stacked segment">                    <div class="field">                        <div class="ui left icon input">                            <i class="user icon"></i>                            <input type="text" name="name" placeholder="请输入用户名">                        </div>                    </div>                    <div class="field">                        <div class="ui left icon input">                            <i class="lock icon"></i>                            <input type="password" name="password" placeholder="请输入密码">                        </div>                    </div>                    <div class="ui fluid large teal submit button">Login</div>                </div>                <div class="ui error message"></div>            </form>        </div>    </div></div><script>    new Vue({        el: '#cen',        data: {            message: [],            search_text: '',            list_sort: [],            id_list: [],            message_id: []        },        /***         * get_id:当点击收藏时获取对应的ID         * del_id:点击取消收藏删除对应的ID         ***/        methods:{            get_id: function (id) {                if (this.id_list.indexOf(id) == -1) {                    //this.id_list.push(id)                    var data = this.message;                    for (var i in data) {                        if (data[i]['id'] == id) {                            this.message_id.push(data[i]);                        }                    }                    }                //if (this.id_list){                //    for (var i in this.id_list){                //        var index = this.id_list[i];                //    }                //}                setTimeout(function () {                        $('.special_del').dimmer({                        on: 'hover'                    });                    }, 500);            },            del_id: function (id) {                var a = this.id_list;                var index = $.inArray(id, a);                a.splice(index, 1);            }        },        /***         获取本地存储ret，         判断本地存储是否存在,         存在则遍历成int类型到sort_list列表中,或初始化为空         ***/        mounted: function () {            var sort_group = localStorage.getItem('sort_group');            var sort_list = [];            if (sort_group) {                var tmp = sort_group.split(',');                for (var i in tmp) {                    sort_list.push(parseInt(tmp[i]))                }            }            console.log('sort_group:', sort_group)            var sort_like = localStorage.getItem('sort_like');            var id_list = [];            if (sort_like){                var id_tmp = sort_like.split(',');                for (var id_i in id_tmp) {                    id_list.push(parseInt(id_tmp[id_i]))                }            }            setTimeout(function () {                        $('.special_del').dimmer({                        on: 'hover'                    });                    }, 500);            // 把获取到的本地存储(已有值或者为空)放到data中的list_sort            this.list_sort = sort_list;            this.id_list = id_list;            var _self = this;            // 获取接口源数据            axios.get('http://0.0.0.0:8000/api/infos')                .then(function (response) {                    var new_data = response.data;                    console.log('new_data:', response);                    function compare(propertyName) {                        return function (object1,object2) {                            var value1 = object1[propertyName];                            var value2 = object2[propertyName];                            if (value2 < value1){                                return -1;                            }                            else if (value2 > value1){                                return 1;                            }                            else {                                return 0;                            }                        }                    }                    new_data.sort(compare("type"));                    //_self.message = response.data;                    _self.message = new_data;                    var data = response.data;                    var sort_group = localStorage.getItem('sort_group');                    // 当本地存储有值的时候根据本地存储的值重新对源数据进行排序，否则数据排序的结果还是源数据                    var message_sort = [];                    if (_self.list_sort) {                        for (var i in _self.list_sort) {                            var index = _self.list_sort[i];                            for (var j in data) {                                if (data[j]['id'] == index) {                                    message_sort.push(data[j]);                                    break                                }                            }                        }                        console.log("message_sort:", message_sort)                    } else {                        message_sort = data;                    }                    //判断新增数据和已经排序的数据是否一样，不一样则将新增的添加到已排序的末尾                    for (var k in data) {                        var flag = false;                        for (var m in message_sort) {                            if (message_sort[m]['id'] == data[k]['id']) {                                flag = true;                                break                            }                        }                        if (!flag) {                            message_sort.push(data[k]);                        }                    }                    var new_sort_data = message_sort;                    new_sort_data.sort(compare("type"));                    _self.message = new_sort_data;                    var sort_like = localStorage.getItem('sort_like');                    // 当本地存储有值的时候根据本地存储的值重新对源数据进行排序，否则数据排序的结果还是源数据                    var message_id = [];                    if (_self.id_list) {                        for (var i_id in _self.id_list) {                            var index_id = _self.id_list[i_id];                            for (var j_id in data) {                                if (data[j_id]['id'] == index_id) {                                    message_id.push(data[j_id]);                                    break                                }                            }                        }                    } else {                        message_id = []                    }                    //判断新增数据和已经排序的数据是否一样，不一样则将新增的添加到已排序的末尾                    /*for (var k_id in data) {                        var flag_id = false;                        for (var m_id in message_sort) {                            if (message_sort[m_id]['id'] == data[k_id]['id']) {                                flag_id = true;                                break                            }                        }                        if (!flag_id) {                            message_id.push(data[k_id]);                            console.log('message_id:', message_id);                        }                    }*/                    _self.message_id = message_id;                    setTimeout(function () {                        $('.special').dimmer({                        on: 'hover'                    });                    }, 500);                });        },        // 动态监听，数据改变时执行        watch: {            list_sort: function (data) {                localStorage.setItem('sort_group', data)            },            message: function (data) {                var result = [];                for (var i in data) {                    if (result.indexOf(data[i]['id']) == -1) {                        result.push(data[i]['id'])                    }                }                //localStorage.setItem('sort_group', result);                this.list_sort = result            },            id_list: function (data) {                localStorage.setItem('sort_like', data)            },            message_id: function (data) {                var result = [];                for (var i in data) {                    if (result.indexOf(data[i]['id']) == -1 ){                        result.push(data[i]['id'])                    }                }                this.id_list = result            }        },        //匹配过滤搜索关键字        computed: {            type_str: function () {                var data = {};                for (var i = 0; i < this.search_data.length; i++) {                    var o = this.search_data[i];                    var _type = o['type'];                    if (_type) {                        //初始化                        if (!(_type in data)) {                            data[_type] = [];                        }                        data[_type].push(o);                    }                }                return data            },            id_data: function () {                setTimeout(function () {                        $('.special_del').dimmer({                        on: 'hover'                    });                    }, 500);                var sort_like = [];                for (var i = 0; i < this.id_list.length; i++) {                    var d = this.id_list[i];                    for (var k = 0; k < this.search_data.length; k++) {                        var s = this.search_data[k];                        if (d == s['id']){                            sort_like.push(s);                        }                    }                }                return sort_like            },            search_data: function () {                var that = this;                return this.message.filter(function (type) {                    return type.name.toLowerCase().indexOf(that.search_text.toLowerCase()) !== -1;                });            }        }    })</script>{% endverbatim %}</body></html>